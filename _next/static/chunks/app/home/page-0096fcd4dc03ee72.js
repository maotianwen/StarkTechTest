(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{8707:function(e,t,n){Promise.resolve().then(n.bind(n,2837))},2837:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return K}});var a=n(8754),i=n(9462),c=n(179),r=n(7162),o=n(2123);let s=[{code:"B",text:"最新动态",children:[{code:"A",text:"每月营收"},{code:"B",text:"每股盈余"},{code:"C",text:"每股净值"}]},{code:"F",text:"股票健诊",children:[{code:"B",text:"每股盈余"}]},{code:"C",text:"财务报表",children:[{code:"B",text:"每股盈余"}]},{code:"D",text:"获利能力",children:[{code:"B",text:"每股盈余"}]},{code:"E",text:"安全性分析",children:[{code:"B",text:"每股盈余"}]},{code:"Q",text:"成长力分析",children:[{code:"B",text:"每股盈余"}]},{code:"J",text:"价值评估",children:[{code:"B",text:"每股盈余"}]},{code:"G",text:"董监与筹码",children:[{code:"B",text:"每股盈余"}]},{code:"H",text:"关键指标",children:[{code:"B",text:"每股盈余"}]},{code:"I",text:"产品组合",children:[{code:"B",text:"每股盈余"}]}];var l=()=>{let[e,t]=(0,o.useState)("B"),[n,l]=(0,o.useState)([]),[d,u]=(0,o.useState)("B");return(0,a.jsxs)(r.ZP,{container:!0,wrap:"nowrap",children:[(0,a.jsx)(r.ZP,{item:!0,md:6,children:(0,a.jsx)(i.Z,{orientation:"vertical",value:e,onChange:(e,n)=>{var a;t(n);let i=null===(a=s.find(e=>e.code===n))||void 0===a?void 0:a.children;i&&(l(i),u(i[0].code))},children:s.map(e=>(0,a.jsx)(c.Z,{sx:{whiteSpace:"nowrap"},label:e.text,value:e.code},e.code))})}),(0,a.jsx)(r.ZP,{item:!0,md:4,children:(0,a.jsx)(i.Z,{orientation:"vertical",value:d,onChange:(e,t)=>u(t),children:null==n?void 0:n.map(e=>(0,a.jsx)(c.Z,{sx:{whiteSpace:"nowrap"},label:e.text,value:e.code},e.code))})})]})},d=n(3951),u=n(4587);async function x(e,t){let n=new URLSearchParams(t).toString(),a=new Request("".concat("https://api.finmindtrade.com","/").concat(e,"?").concat(n),{method:"GET"});return(await window.fetch(a)).json()}async function h(e){return await x("api/v4/data",{...e,dataset:"TaiwanStockInfo"})}async function p(e){return await x("api/v4/data",{...e,dataset:"TaiwanStockMonthRevenue"})}var v=n(472),f=n(5658),j=n(8730),m=n(4520),g=n(9920),Z=n(7254);function y(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function S(e,t){let n=[];for(let a of t){let t=e.find(e=>e.revenue_month===a.revenue_month&&e.revenue_year+1===a.revenue_year);if(t){let e=(a.revenue/(null==t?void 0:t.revenue)-1)*100;n.push(e.toFixed(2))}}return n}var _=n(6289),w=n(1344),k=e=>(0,a.jsx)(w.Z,{display:"flex",justifyContent:"center",alignItems:"center",...e,children:(0,a.jsx)(_.Z,{})});function B(e){var t;let{data:n=[],filteredRevenueData:i=[],loading:c}=e,r={position:"sticky",left:0,zIndex:1,whiteSpace:"nowrap",backgroundColor:"white"},s=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let e=s.current;e&&e.scrollWidth>e.clientWidth&&(e.scrollLeft=e.scrollWidth-e.clientWidth)},[n]),(0,a.jsx)(m.Z,{ref:s,children:c?(0,a.jsx)(k,{sx:{height:"140px"}}):(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(g.Z,{children:(0,a.jsxs)(Z.Z,{children:[(0,a.jsx)(j.Z,{sx:{...r},children:"年度月份"}),null==i?void 0:i.map(e=>{var t;return(0,a.jsxs)(j.Z,{align:"right",children:[e.revenue_year,(t=e.revenue_month)<10?"0".concat(t):t.toString()]},e.date)})]})}),(0,a.jsxs)(f.Z,{children:[(0,a.jsxs)(Z.Z,{children:[(0,a.jsx)(j.Z,{sx:{...r,fontWeight:500},children:"每月营收"}),null==i?void 0:i.map(e=>(0,a.jsx)(j.Z,{align:"right",children:y(e.revenue)},e.date))]}),(0,a.jsxs)(Z.Z,{children:[(0,a.jsx)(j.Z,{sx:{...r,fontWeight:500},children:"单月营收年增率（%）"}),null===(t=S(n,i))||void 0===t?void 0:t.map((e,t)=>(0,a.jsx)(j.Z,{align:"right",children:e},t))]})]})]})})}var P=n(6008),b=n(4364);let C=(0,n(4241).Ue)(e=>({stockTitle:"",setStockTitle:t=>e({stockTitle:t})}));var I=n(863),R=n(6973),E=n(1070),N=n(6099),T=n(3203),L=n(7178),W=n(4271),D=n(8525),F=n(890),O=n(6596),z=n(9905),U=n(3652);N.D([L.N,W.N,D.N,F.N,O.N,U.N,z.z]);var A=e=>{let{data:t=[],filteredRevenueData:n=[],loading:i}=e,c=(0,o.useMemo)(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["每月营收","单月营收年增率"]},xAxis:[{type:"category",data:null==n?void 0:n.map(e=>"".concat(e.revenue_year,"/").concat(e.revenue_month)),axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"千元",axisLabel:{formatter:"{value}",rotate:45}},{type:"value",name:"%",axisLabel:{formatter:"{value}%"}}],series:[{name:"每月营收",type:"bar",itemStyle:{color:"#faad14"},tooltip:{valueFormatter:function(e){return"number"==typeof e?y(e):"".concat(e)}},data:null==n?void 0:n.map(e=>e.revenue)},{name:"单月营收年增率",type:"line",itemStyle:{color:"#cf1322"},yAxisIndex:1,tooltip:{valueFormatter:function(e){return"".concat(e,"%")}},data:S(t,n)}]}),[t,n]),r=(0,o.useRef)(null),s=(0,o.useRef)(null);return(0,o.useEffect)(()=>{r.current&&(s.current||(s.current=T.S1(r.current)),s.current.setOption(c))},[c]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k,{sx:{display:i?"flex":"none",height:400}}),(0,a.jsx)(w.Z,{ref:r,sx:{height:400,display:i?"none":"flex"}})]})},M=n(8186),q=e=>{let{visible:t}=e;return(0,a.jsxs)(P.Z,{elevation:3,sx:{display:t?"flex":"none",justifyContent:"center",alignItems:"center",height:480},children:[(0,a.jsx)(M.Z,{color:"disabled"}),(0,a.jsx)("span",{style:{color:"#00000042"},children:"暂无数据"})]})},G=()=>{let e=(0,u.useSearchParams)(),[t,n]=(0,o.useState)("4");(0,o.useEffect)(()=>{(async()=>{let n=new URLSearchParams(e).get("id");if(n){let[e]=n.split("_");l(!0);let a=await p({data_id:e,start_date:function(e){let t=new Date,n=t.getFullYear()-e,a=t.getMonth()+1,i=t.getDate();return"".concat(n,"-").concat(a.toString().padStart(2,"0"),"-").concat(i.toString().padStart(2,"0"))}(parseInt(t))});l(!1),200===a.status&&c(a.data)}else c([])})()},[e,t]);let[i,c]=(0,o.useState)(),r=(0,o.useMemo)(()=>null==i?void 0:i.slice(12),[i]),[s,l]=(0,o.useState)(!1),d=C(e=>e.stockTitle),x=!s&&!!i&&0===i.length;return(0,a.jsxs)("div",{children:[(0,a.jsx)(q,{visible:x}),(0,a.jsxs)(w.Z,{sx:{display:x?"none":"block"},children:[(0,a.jsx)(P.Z,{elevation:3,children:(0,a.jsx)(w.Z,{display:"flex",alignItems:"center",padding:"16px",marginBottom:"20px",children:d})}),(0,a.jsxs)(P.Z,{elevation:3,sx:{padding:"16px",marginBottom:"20px"},children:[(0,a.jsxs)(w.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px",children:[(0,a.jsx)(b.Z,{variant:"contained",size:"large",children:"每月营收"}),(0,a.jsx)(R.Z,{variant:"outlined",children:(0,a.jsxs)(I.Z,{size:"small",variant:"outlined",onChange:e=>{n(e.target.value)},value:t,children:[(0,a.jsx)(E.Z,{value:"4",children:"近3年"}),(0,a.jsx)(E.Z,{value:"6",children:"近5年"}),(0,a.jsx)(E.Z,{value:"9",children:"近8年"})]})})]}),(0,a.jsx)(A,{data:i,filteredRevenueData:r,loading:s})]}),(0,a.jsxs)(P.Z,{elevation:3,children:[(0,a.jsx)(b.Z,{variant:"contained",size:"large",sx:{margin:"16px"},children:"详细数据"}),(0,a.jsx)(B,{data:i,filteredRevenueData:r,loading:s})]})]})]})},V=n(8432),H=n(853),J=()=>{let e=(0,u.useSearchParams)(),t=(0,u.usePathname)(),{replace:n}=(0,u.useRouter)(),i=C(e=>e.setStockTitle),[c,s]=(0,o.useState)([]);(0,o.useEffect)(()=>{(async()=>{let e=await h({});200===e.status&&s(e.data.map((e,t)=>({...e,index:t})))})()},[]);let[l,d]=(0,o.useState)(null);(0,o.useEffect)(()=>{let t=new URLSearchParams(e).get("id");if(t){let e=c.find(e=>"".concat(e.stock_id,"_").concat(e.index)===t);e&&(d(e),v("".concat(e.stock_id).concat(e.industry_category).concat(e.stock_name)),i("".concat(e.stock_name,"（").concat(e.stock_id,"）")))}},[e,c,i]);let x=a=>{if(a){let i="".concat(a.stock_id,"_").concat(a.index),c=new URLSearchParams(e);c.set("id",i),n("".concat(t,"?").concat(c.toString())),d(a)}},[p,v]=(0,o.useState)("");return(0,a.jsx)(P.Z,{elevation:3,children:(0,a.jsx)(r.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",sx:{padding:"20px",marginBottom:"30px"},children:c.length>0?(0,a.jsx)(H.Z,{disablePortal:!0,getOptionLabel:e=>"".concat(e.stock_id).concat(e.industry_category).concat(e.stock_name),getOptionKey:e=>"".concat(e.stock_id,"_").concat(e.index),options:c,isOptionEqualToValue:(e,t)=>"".concat(e.stock_id,"_").concat(e.index)==="".concat(t.stock_id,"_").concat(t.index),value:l,inputValue:p,onInputChange:(e,t)=>v(t),onChange:(e,t)=>x(t),sx:{width:300},renderInput:e=>(0,a.jsx)(V.Z,{...e,placeholder:"输入台/美股代号，查看公司价值"})}):(0,a.jsx)(_.Z,{})})})};function K(){return(0,a.jsxs)(o.Suspense,{fallback:(0,a.jsx)(_.Z,{}),children:[(0,a.jsx)(J,{}),(0,a.jsx)(d.Z,{sx:{minWidth:1200,paddingBottom:"30px"},children:(0,a.jsxs)(r.ZP,{container:!0,spacing:2,wrap:"nowrap",children:[(0,a.jsx)(r.ZP,{item:!0,sx:{minWidth:260},children:(0,a.jsx)(l,{})}),(0,a.jsx)(r.ZP,{item:!0,sm:12,lg:8,children:(0,a.jsx)(G,{})})]})})]})}}},function(e){e.O(0,[7,799,146,672,744],function(){return e(e.s=8707)}),_N_E=e.O()}]);